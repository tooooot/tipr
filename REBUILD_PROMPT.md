# ๐ ุจุฑููุจุช ุฅุนุงุฏุฉ ุจูุงุก ุชุทุจูู TIBR - ููุตุฉ ุงูุฑูุจูุชุงุช ุงูุงุณุชุซูุงุฑูุฉ

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุฃุฑูุฏ ุจูุงุก ุชุทุจูู ููุจ ุนุฑุจู ููุชุฏุงูู ุงูุขูู ูู ุงูุณูู ุงูุณุนูุฏู ูุณูู **"ุชูุจุฑ" (TIBR)**. ุงูุชุทุจูู ูุญุชูู ุนูู 10 ุฑูุจูุชุงุช ุงุณุชุซูุงุฑูุฉ ุฐููุฉ ููู ูููุง ุงุณุชุฑุงุชูุฌูุฉ ูุฎุชููุฉุ ูุน ูุญุงูุงุฉ ุชุงุฑูุฎูุฉ (Time Machine) ูุงุฎุชุจุงุฑ ุงูุงุณุชุฑุงุชูุฌูุงุช ุนูู ุจูุงูุงุช ุญููููุฉ.

---

## ๐๏ธ ุงููููู ุงูุชููู

### Backend (Python FastAPI)
```
backend/
โโโ app/
โ   โโโ main.py                    # FastAPI app + all endpoints
โ   โโโ services/
โ   โ   โโโ market_engine.py       # Yahoo Finance data fetching + technical indicators
โ   โ   โโโ backtest_engine.py     # Time Machine simulator
โ   โโโ models/
โโโ requirements.txt
```

### Frontend (React + Vite)
```
frontend/
โโโ src/
โ   โโโ App.jsx                    # Main app with all components
โ   โโโ main.jsx
โ   โโโ index.css
โโโ public/
โ   โโโ manifest.json              # PWA manifest
โ   โโโ sw.js                      # Service worker
โโโ package.json
```

---

## ๐ค ุงูุฑูุจูุชุงุช ุงูุนุดุฑุฉ

| ุงุณู ุงูุฑูุจูุช | Emoji | ุงูุงุณุชุฑุงุชูุฌูุฉ | ูุณุชูู ุงููุฎุงุทุฑุฉ | ุดุฑุท ุงูุดุฑุงุก |
|------------|-------|-------------|---------------|-----------|
| ุงููุงูู | ๐ | ููู/ุงุชุฌุงู | ูุชูุณุท | ุงูุณุนุฑ > SMA50 + ุญุฌู > 150% ูุชูุณุท |
| ุงูููุงุต | ๐ฏ | ุณูุงูุจููุฌ | ุนุงูู | RSI < 30 (ุชุดุจุน ุจูุนู) |
| ุงูุฌุณูุฑ | ๐ฆ | ูุฎุงุทุฑ ุนุงููุฉ | ุนุงูู ุฌุฏุงู | ุงูุฎูุงุถ ูููู > 3% |
| ุงูุจุฑู | โก | ุฒุฎู ุณุฑูุน | ุนุงูู ุฌุฏุงู | ุทูุฑุฉ ุญุฌู > 3 ุงูุญุฑุงู ูุนูุงุฑู |
| ุงูุจุตูุฑุฉ | ๐๏ธ | ุชุญููู ุฃุฎุจุงุฑ | ูุชูุณุท | ุฃุฎุจุงุฑ ุฅูุฌุงุจูุฉ |
| ุงูุฑุฒูู | โ๏ธ | ูููุฉ | ููุฎูุถ | P/E < 15 |
| ุงูุฎุจูุฑ | ๐ง | ุชุญููู ููู ููุงุณููู | ูุชูุณุท | ุชูุงุทุน ุฐูุจู SMA50 > SMA200 |
| ุงูุฑุงุณู | ๐๏ธ | ุชูุฒูุนุงุช | ููุฎูุถ | ุนุงุฆุฏ ุชูุฒูุนุงุช > 4% |
| ุงูุฐุฎูุฑุฉ | ๐ฐ | DCA ุดูุฑู | ููุฎูุถ ุฌุฏุงู | ุดุฑุงุก ุฃูู ูู ุดูุฑ |
| ุงูููุฏุฑูุน | ๐ก๏ธ | ุชุญูุท | ููุฎูุถ | ุชูููุน ุงููุทุงุนุงุช |

---

## ๐ฑ ุตูุญุงุช ุงูุชุทุจูู

### 1. ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ (Dashboard)
- ุชุฑุญูุจ ุงููุณุชุฎุฏู
- ููุฎุต ุงููุญูุธุฉ (ุงูุฑุตูุฏุ ุงูุฑุจุญ/ุงูุฎุณุงุฑุฉ)
- ูุงุฆูุฉ ุงูุฑูุจูุชุงุช ูุน ุฃุฏุงุฆูุง
- ุขุฎุฑ ุงูุตููุงุช

### 2. ุตูุญุฉ ุงูุจุซ ุงููุจุงุดุฑ (Live)
- ุชุญุฏูุซุงุช ูุจุงุดุฑุฉ ูู ุงูุฑูุจูุชุงุช
- ูุงุฐุง ูุฑุงูุจ ูู ุฑูุจูุช ุงูุขู
- ุขุฎุฑ ุงูุฅุดุงุฑุงุช

### 3. ุตูุญุฉ ุงูุฑูุจูุชุงุช (Bots)
- ุนุฑุถ ูู ุงูุฑูุจูุชุงุช ุงูุนุดุฑุฉ
- ููุชุฑุฉ ุญุณุจ ุงููุฎุงุทุฑุฉ
- ุชุฑุชูุจ ุญุณุจ ุงูุฃุฏุงุก

### 4. ููู ุงูุฑูุจูุช (BotProfile)
- ุชูุงุตูู ุงูุฑูุจูุช (ุงูุงุณูุ ุงูุงุณุชุฑุงุชูุฌูุฉุ ุงููุฎุงุทุฑุฉ)
- **ุฑุตูุฏ ุงููุญูุธุฉ** ูู ุงููุญุงูุงุฉ
- **ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก**: ุฅุฌูุงูู ุงูุฑุจุญุ ูุณุจุฉ ุงูููุฒุ ุงูุตููุงุชุ ุฃูุตู ุชุฑุงุฌุน
- **ุนุฏุฏ ุงูุตููุงุช ุงูุฑุงุจุญุฉ/ุงูุฎุงุณุฑุฉ**
- **ููุญูู ุงูููู** (Equity Curve)
- **ูุงุฆูุฉ ุงูุตููุงุช** ูุน ุงูุชูุงุตูู

### 5. ุชูุงุตูู ุงูุตููุฉ (TradeDetails)
**ููุณูุฉ ูุฌุฒุฆูู ูุงุถุญูู:**

#### ุงูุฌุฒุก ุงูุฃูู: ูุจู ุงูุตููุฉ
- ููุงุฐุง ูุฑุฑ ุงูุฑูุจูุช ุงูุฏุฎููุ
- ุฎุทุฉ ุงูุตููุฉ:
  - ุณุนุฑ ุงูุฏุฎูู
  - ุงููุฏู (+3%)
  - ููู ุงูุฎุณุงุฑุฉ (-1.5%)
- ุชุงุฑูุฎ ุงูุฏุฎูู ูุงููููุฉ

#### ุงูุฌุฒุก ุงูุซุงูู: ูุง ุญุฏุซ ูุนูุงู
- ูุชูุฌุฉ ุงูุตููุฉ (๐ ูุงุฌุญุฉ ุฃู ๐ ุฎุงุณุฑุฉ)
- ูุณุจุฉ ุงูุฑุจุญ/ุงูุฎุณุงุฑุฉ
- ููุงุฑูุฉ: ุณุนุฑ ุงูุฏุฎูู vs ุงูุฎุฑูุฌ
- ุงูุฏุฑุณ ุงููุณุชูุงุฏ
- ุฃู โณ "ุงูุตููุฉ ููุชูุญุฉ" ุฅุฐุง ูู ุชูุบูู

#### ุฑูุงุจุท ุงูุชุญูู
- TradingView (ูุน ุฑูุฒ ุงูุณูู ุงูุตุญูุญ)
- ูููุน ุชุฏุงูู ุงูุฑุณูู
- ุฃุฑูุงู

### 6. ุงูุฃุฎุจุงุฑ (News)
- ุขุฎุฑ ุฃุฎุจุงุฑ ุงูุณูู ุงูุณุนูุฏู
- ุชุญููู ุงููุดุงุนุฑ
- ูุงุฐุง ูุฑุงูุจ ูู ุฑูุจูุช

### 7. ุงูุฅุนุฏุงุฏุงุช + ุขูุฉ ุงูุฒูู (Settings)
- **ุขูุฉ ุงูุฒูู (Time Machine)**:
  - ุงุฎุชูุงุฑ ุชุงุฑูุฎ ุงูุจุฏุก ูุงูุงูุชูุงุก
  - ุชุญุฏูุฏ ุฑุฃุณ ุงููุงู
  - ุฒุฑ ุชุดุบูู ุงููุญุงูุงุฉ
  - **ุงููุชุงุฆุฌ**:
    - ุงููุงุฆุฒ (ุฃูุถู ุฑูุจูุช)
    - ุงููุงุฆุฒูู ุงูุฃุณุจูุนููู
    - ููุญุฉ ุงูุชุฑุชูุจ (Leaderboard)

---

## ๐ API Endpoints

### GET /api/bots
```json
{
  "data": [
    {
      "id": "al_nami",
      "name_ar": "ุงููุงูู",
      "name_en": "The Grower",
      "emoji": "๐",
      "strategy_ar": "ุงุณุชุฑุงุชูุฌูุฉ ุงูููู ูุงูุงุชุฌุงู",
      "risk_level": "ูุชูุณุท",
      "description_ar": "ูุจุญุซ ุนู ุงูุฃุณูู ุงูุชู ุชุฎุชุฑู ููุงููุงุช ูููุฉ..."
    }
  ]
}
```

### GET /api/bots/{bot_id}
ุชูุงุตูู ุฑูุจูุช ูุงุญุฏ

### POST /api/backtest/run
```
?start_date=2024-01-01&initial_capital=100000
```

**ุงูุฑุฏ:**
```json
{
  "leaderboard": [
    {
      "bot_id": "al_nami",
      "name_ar": "ุงููุงูู",
      "emoji": "๐",
      "total_profit_pct": 12.5,
      "total_trades": 45,
      "winning_trades": 28,
      "losing_trades": 17,
      "win_rate": 62.2,
      "max_drawdown": 5.2,
      "final_balance": 112500,
      "initial_capital": 100000
    }
  ],
  "weekly_winners": [
    { "week": 1, "winner_id": "al_nami", "profit_pct": 2.1 }
  ],
  "bot_portfolios": {
    "al_nami": {
      "final_balance": 112500,
      "initial_capital": 100000,
      "total_profit": 12500,
      "total_profit_pct": 12.5,
      "total_trades": 45,
      "winning_trades": 28,
      "losing_trades": 17,
      "win_rate": 62.2,
      "max_drawdown": 5.2,
      "equity_curve": [100000, 100500, 101200, ...],
      "trades": [
        {
          "symbol": "2222.SR",
          "action": "buy",
          "price": 32.50,
          "quantity": 100,
          "date": "2024-06-15",
          "profit_pct": 3.0,
          "reason_ar": "ุงูุณุนุฑ ุงุฎุชุฑู SMA50..."
        }
      ]
    }
  }
}
```

### GET /api/news
ุฃุฎุจุงุฑ ุงูุณูู

---

## ๐พ ูุดุงุฑูุฉ ุจูุงูุงุช ุงููุญุงูุงุฉ

ุงุณุชุฎุฏู `localStorage` ูุญูุธ ูุชุงุฆุฌ ุงููุญุงูุงุฉ:

```javascript
const SIMULATION_KEY = 'tibr_simulation_data';

function saveSimulationData(data) {
  localStorage.setItem(SIMULATION_KEY, JSON.stringify({
    ...data,
    savedAt: new Date().toISOString()
  }));
}

function getSimulationData() {
  const data = localStorage.getItem(SIMULATION_KEY);
  return data ? JSON.parse(data) : null;
}

function getBotPortfolio(botId) {
  const sim = getSimulationData();
  return sim?.bot_portfolios?.[botId] || null;
}
```

---

## ๐ ููุทู ุฅุบูุงู ุงูุตููุงุช

ูู ุตููุฉ ุชูุบูู ุจุฃุญุฏ ุงูุทุฑู ุงูุชุงููุฉ:
1. **๐ฏ ูุตูู ุงููุฏู**: ุงูุณุนุฑ ูุตู +3%
2. **๐ ููู ุงูุฎุณุงุฑุฉ**: ุงูุณุนุฑ ููุฒู -1.5%
3. **โฑ๏ธ ุงูุชูุงุก ุงููุฏุฉ**: ุจุนุฏ 10 ุฃูุงู ุชุฏุงูู

```python
def _check_and_close_positions(self, bot_id, day_idx, date, stock_data):
    for symbol, position in list(self.positions[bot_id].items()):
        current_price = df.iloc[day_idx]['close']
        profit_pct = (current_price - position.entry_price) / position.entry_price * 100
        days_held = (date - position.entry_date).days
        
        if current_price >= position.take_profit:
            # ูุตู ูููุฏู
            close_position()
        elif current_price <= position.stop_loss:
            # ููู ุงูุฎุณุงุฑุฉ
            close_position()
        elif days_held >= 10:
            # ุฅุบูุงู ุจุนุฏ 10 ุฃูุงู
            close_position()
```

---

## ๐จ ุงูุชุตููู

### ุงูุฃููุงู
- **ุงูุฎูููุฉ**: `#0f172a` (Navy Dark)
- **ุงูุจุทุงูุงุช**: `#1e293b`
- **ุงูุฐูุจู**: `#fbbf24` (ุงูููู ุงูุฑุฆูุณู)
- **ุงูุฃุฎุถุฑ**: `#22c55e` (ุฑุจุญ)
- **ุงูุฃุญูุฑ**: `#ef4444` (ุฎุณุงุฑุฉ)
- **ุงูุฑูุงุฏู**: `#9ca3af` (ูุต ุซุงููู)

### ุงูุฎุทูุท
- ุงุชุฌุงู RTL (ูููู ูููุณุงุฑ)
- ุฎุท ุนุฑุจู ูุงุถุญ

### BottomNav
5 ุฃููููุงุช: ุงูุฑุฆูุณูุฉ | ุงูุจุซ | ุงูุฑูุจูุชุงุช | ุงูุฑุงุตุฏ | ุงูุฅุนุฏุงุฏุงุช

---

## ๐ฑ PWA Features

- `manifest.json` ูุน ุฃููููุงุช
- `sw.js` ููู caching
- ูุงุจู ููุชุซุจูุช ุนูู ุงููุงุชู

---

## ๐ง Dependencies

### Backend (requirements.txt)
```
fastapi
uvicorn
yfinance
pandas
numpy
python-dotenv
httpx
```

### Frontend (package.json)
```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0"
  },
  "devDependencies": {
    "vite": "^6.0.0",
    "@vitejs/plugin-react": "^4.2.0"
  }
}
```

---

## ๐ ุฃูุงูุฑ ุงูุชุดุบูู

```bash
# Backend
cd backend
pip install -r requirements.txt
python -m uvicorn app.main:app --reload --port 8000

# Frontend
cd frontend
npm install
npm run dev
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงูุจูุงูุงุช ูู Yahoo Finance** - ูุฏ ุชุฃุฎุฐ ููุชุงู ููุชุญููู
2. **ุงูุตููุงุช ูุฌุจ ุฃู ุชูุบูู** - ูุง ุชุชุฑู ุตููุงุช ููุชูุญุฉ ูุฃุดูุฑ
3. **ุฑูุงุจุท TradingView** - ุงุณุชุฎุฏู `TADAWUL%3A{ุฑูู_ุงูุณูู}` ุจุฏูู `.SR`
4. **ุงููุบุฉ ุงูุนุฑุจูุฉ** - ูู ุงููุตูุต ุจุงูุนุฑุจูุฉ
5. **ุงูุชุตููู ุงููุงุฎุฑ** - ุงุณุชุฎุฏู ุงูุชุฏุฑุฌุงุช ูุงูุธูุงู

---

## ๐ฏ ุงููุฏู ุงูููุงุฆู

ุชุทุจูู ููุธูุฑ:
1. โ 10 ุฑูุจูุชุงุช ุจุดุฎุตูุงุช ูุฎุชููุฉ
2. โ ูุญุงูุงุฉ ุนูู ุจูุงูุงุช ุญููููุฉ
3. โ ุตููุงุช ุชููุชุญ ูุชูุบูู ุจุดูู ูุงูุนู
4. โ ุชูุงุตูู ุงูุตููุฉ: ูุจู ูุจุนุฏ
5. โ ุฅุญุตุงุฆูุงุช ุฏูููุฉ (ุฑุจุญุ ุฎุณุงุฑุฉุ ูุณุจุฉ ููุฒ)
6. โ ุฑูุงุจุท ููุชุญูู ุงูุฎุงุฑุฌู
7. โ ุชุตููู ุนุฑุจู ูุงุฎุฑ
